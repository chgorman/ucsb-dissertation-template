\begin{algorithm}[t]
\caption{Solve MSN System using Slow, Stable Algorithm}
\label{alg:slow_msn_lq}
\begin{algorithmic}[1]
\Function{slow\_msn\_solve}{$f$,$V$,$D_{s}$}
\Comment{Solve $\min_{Va=f}\norm{D_{s}a}_{2}$.}
    \State Compute $P_{1}L_{1}Q_{1}=V$ using an LQ factorization
        based on QRCP.
    \State Determine permutation $\Pi$ such that $Q_{1}D_{s}^{-1}\Pi$
        has decreasing column norms.
    \State Compute the SVD:
        $U\Sigma V^{*} = Q_{1}D_{s}^{-1}\Pi$; only $U$ is stored.
    \State Compute $P_{2}L_{2}Q_{2} = U^{*}Q_{1}D_{s}^{-1}\Pi$.
    \State Solve $L_{1}z = P_{1}^{*}f$.
    \State Solve $L_{2}y = P_{2}^{*}U^{*}z$.
    \State $a = D_{s}^{-1}\Pi Q_{2}^{*}y$
    \State \Return $a$
\EndFunction
\end{algorithmic}
\end{algorithm}
